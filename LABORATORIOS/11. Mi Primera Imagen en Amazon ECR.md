## Introducci√≥n a Amazon ECR

**Amazon Elastic Container Registry (ECR)** es un registro de contenedores de Docker completamente administrado.  
Facilita a los desarrolladores las tareas de **almacenamiento, administraci√≥n e implementaci√≥n** de im√°genes de contenedores Docker.

Amazon ECR aloja sus im√°genes en una **arquitectura escalable y de alta disponibilidad**, lo que permite implementar contenedores para sus aplicaciones con fiabilidad.

---

## Resumen de Tareas

El objetivo es **subir una imagen de una aplicaci√≥n a Elastic Container Registry (ECR)**.  
Las tareas a realizar son:

1. Crear una aplicaci√≥n web simple.  
2. Crear una imagen Docker de la aplicaci√≥n web.  
3. Enviar la imagen Docker a AWS ECR.

---

## 1Ô∏è‚É£ Aplicaci√≥n Web

Se construir√° una aplicaci√≥n web muy sencilla que consta de un archivo **HTML**.

### Preparaci√≥n del Entorno

Se utilizar√° la **consola web de AWS** y su herramienta integrada **AWS CloudShell**, que ya incluye **Docker** y la **AWS CLI** preinstalados, eliminando la necesidad de trabajar en la m√°quina local.

Para abrir AWS CloudShell:
- Inicia sesi√≥n en la consola de AWS.  
- Haz clic en el icono de **CloudShell** en la barra de navegaci√≥n superior.

---

### Creaci√≥n del Directorio del Proyecto

```bash
mkdir demoNinjaDocker
cd demoNinjaDocker
````

---

### Creaci√≥n de `index.html`

Usa un editor o el siguiente comando `cat` para crear el archivo HTML con el contenido:

```bash
cat > index.html <<EOF
<!DOCTYPE html>
<html>
<body style="background-color: rgb(210, 226, 250)">
<h1>Bienvenido al Taller Ninja</h1>
<p>Ninja Project BBVA</p>
<p>Application Version: $V1</p>
</body>
</html>
EOF
```

---

## 2Ô∏è‚É£ Crear Imagen Docker de la Aplicaci√≥n

**Docker** puede construir im√°genes autom√°ticamente leyendo las instrucciones de un fichero **Dockerfile**.
Este es un documento de texto que contiene todas las √≥rdenes necesarias para crear una imagen.

---

### Creaci√≥n del `Dockerfile`

El siguiente archivo usa la imagen base de **Nginx** y copia el HTML al directorio ra√≠z de contenido del servidor:

```bash
cat > Dockerfile <<EOF
FROM nginx
COPY index.html /usr/share/nginx/html
EOF
```

---

### Construcci√≥n de la Imagen Docker

Desde el directorio `~/demoNinjaDocker`, ejecuta:

```bash
docker build -t ninja-docker .
```

> **Nota:**
> El comando etiqueta la imagen con el nombre `ninja-docker`.
> El punto (`.`) indica que se busque el `Dockerfile` en el directorio actual.

---

## 3Ô∏è Enviar la Imagen a AWS ECR

Antes de enviar la imagen, se necesita **crear el repositorio en ECR**.

---

### üè¢ Creaci√≥n del Repositorio ECR

1. En la consola de AWS, navega a **Elastic Container Registry (ECR)**.
2. Crea un nuevo repositorio con el nombre, por ejemplo:
   **`demo-ninja`**
3. Las configuraciones **Tag immutability** y **Scan on push** se muestran como *Disabled*.

---

### Obtener los Comandos de Env√≠o (‚ÄúView push commands‚Äù)

Una vez creado el repositorio:

* Ingresa al repositorio.
* Haz clic en **‚ÄúView push commands‚Äù** para obtener los comandos necesarios para subir la imagen.

---

### Ejecuci√≥n de Comandos para Subir la Imagen

Sigue los pasos 1, 3 y 4 proporcionados en el modal *‚ÄúPush commands for demo-ninja‚Äù*:

#### 1. Autenticaci√≥n de Docker

```bash
aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin 818929933852.dkr.ecr.us-east-1.amazonaws.com
```

#### 2. Etiquetar la Imagen (Tag)

> El intento inicial con `docker tag demo-ninja:latest ...` falla porque la imagen `demo-ninja:latest` no existe.

Comando corregido:

```bash
docker tag ninja-docker:latest 818929933852.dkr.ecr.us-east-1.amazonaws.com/demo-ninja:latest
```

#### 3. Enviar la Imagen (Push)

```bash
docker push 818929933852.dkr.ecr.us-east-1.amazonaws.com/demo-ninja:latest
```

---

## Verificaci√≥n del Resultado

Al finalizar, la imagen subida debe reflejarse en el repositorio **ECR** y estar lista para ser utilizada.

* El repositorio **`demo-ninja`** muestra **Images (1)**.
* La imagen con la etiqueta `latest` aparece en la lista con su tama√±o y detalles.

> El repositorio puede tener m√°s de una versi√≥n de la imagen.




