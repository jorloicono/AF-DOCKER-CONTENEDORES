La contenedorización ha transformado la implementación de aplicaciones, pero a medida que el número de contenedores crece, su control y coordinación se vuelve complejo.  
**Kubernetes** es la solución líder de orquestación, y **Azure Kubernetes Service (AKS)** es el servicio administrado de Microsoft Azure que simplifica su uso en la nube de Azure.

---

## Terminologías Clave

| Concepto | Definición |
| :--- | :--- |
| **Contenerización** | Proceso de empaquetar el código de la aplicación con todos los archivos y librerías en una unidad única para garantizar consistencia y portabilidad. |
| **Kubernetes** | Plataforma de orquestación de código abierto que automatiza la implementación, escalamiento y gestión de aplicaciones en contenedores. |
| **Azure Kubernetes Service (AKS)** | Servicio de Kubernetes administrado por Microsoft Azure que simplifica la implementación y gestión de clústeres en Azure. |
| **Pod** | La unidad implementable más pequeña en Kubernetes, que representa uno o más contenedores estrechamente acoplados. |
| **Deployment** | Objeto de Kubernetes que define el estado deseado de los Pods y ReplicaSets, asegurando que se ejecute un número específico de réplicas de la aplicación. |
| **Service** | Objeto que define un conjunto lógico de Pods y una política para acceder a ellos, como un *LoadBalancer* o *NodePort*. |

---

## Resumen del Tutorial

Este laboratorio guía a través del proceso de creación de un **clúster AKS** y el despliegue de una **aplicación web NGINX**.

1. Crear un clúster de **AKS**.  
2. Conectarse al clúster de AKS.  
3. Implementar una aplicación de prueba.  
4. Exponer la aplicación a internet.  
5. Escalar la aplicación.  
6. Limpiar los recursos.

---

## 1. Creación y Conexión al Clúster AKS

### 1.1. Configuración Inicial y Creación del Grupo de Recursos

Usaremos la **Azure CLI** y **`kubectl`**.

**Creación del Grupo de Recursos:**
```bash
az group create --name NinjaAKSResourceGroup --location eastus
````

**Creación del Clúster AKS:**
Crea un clúster con 2 nodos de tipo `Standard_DS2_v2` dentro del grupo de recursos recién creado.

> Este proceso puede tardar varios minutos.

```bash
az aks create \
--resource-group NinjaAKSResourceGroup \
--name NinjaAKSCluster \
--node-count 2 \
--node-vm-size Standard_DS2_v2 \
--enable-managed-identity \
--generate-ssh-keys
```

---

### 1.2. Conexión a Azure y al Clúster

**Inicio de sesión en Azure:**

```bash
az login
```

**Configuración de `kubectl`:**
Obtiene las credenciales del clúster AKS y las agrega al archivo de configuración.

```bash
az aks get-credentials --resource-group NinjaAKSResourceGroup --name NinjaAKSCluster
```

**Verificación del acceso:**

```bash
kubectl get nodes
```

---

## 2. Despliegue de la Aplicación de Prueba

Se implementa una aplicación NGINX utilizando un *Deployment* y un *Service* de Kubernetes.

### 2.1. Implementación del Deployment

Crea el archivo `nginx-deployment.yaml` para definir el despliegue con 3 réplicas.

```yaml
# 01-nginx-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        ports:
        - containerPort: 80
```

**Aplicar el manifiesto:**

```bash
kubectl apply -f nginx-deployment.yaml
```

---

### 2.2. Exposición de la Aplicación (Service)

Se crea un *Service* de tipo **LoadBalancer** para exponer la aplicación a internet en el puerto 80.
Azure se encarga de aprovisionar automáticamente un **Azure Load Balancer** externo.

```yaml
# 02-nginx-loadbalancer-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: nginx-service
spec:
  selector:
    app: nginx
  type: LoadBalancer
  ports:
  - port: 80
    targetPort: 80
```

**Aplicar el Service:**

```bash
kubectl apply -f nginx-loadbalancer-service.yaml
```

**Comprobar el estado del servicio:**

```bash
kubectl get service nginx-service --watch
```

> **Resultado esperado:**
> El servicio `nginx-service` obtiene una IP externa (por ejemplo: `20.87.237.92`).

---

### 2.3. Acceso a la Aplicación

Abre la IP externa obtenida en tu navegador (ejemplo: `http://20.87.237.92`).

> Verás la página:
> **“Welcome to nginx!”**
> confirmando el éxito del despliegue.

---

## 3. Escalamiento de la Aplicación

Puedes escalar el número de réplicas fácilmente con el siguiente comando:

**Escalar a 5 réplicas:**

```bash
kubectl scale deployment nginx-deployment --replicas 5
```

**Verificar el escalado:**

```bash
kubectl get deployment nginx-deployment
kubectl get pods
```

---

## 4. Monitoreo del Clúster

**AKS** se integra con **Azure Monitor**, permitiendo observar métricas de rendimiento, estado y registros.

**Desde el Portal de Azure:**

1. Abre tu clúster **AKS**.
2. Selecciona la pestaña **“Supervisión”**.
3. Explora las secciones de métricas, rendimiento y diagnóstico.

---

## 5. Limpieza de Recursos

Para evitar costos innecesarios, elimina todos los recursos creados al finalizar.

**Eliminar el Grupo de Recursos (y todo su contenido):**

```bash
az group delete --name NinjaAKSResourceGroup --yes --no-wait
```

---

## Resultado Final

Has creado, desplegado y gestionado una aplicación web NGINX en **Azure Kubernetes Service (AKS)**.

- **Azure CLI** — para gestionar recursos.
- **kubectl** — para controlar los objetos de Kubernetes.
- **AKS** — para orquestar y escalar aplicaciones fácilmente.


¿Deseas que te lo genere como archivo descargable (`Uso_AKS.md`) para que puedas bajarlo directamente?
```
